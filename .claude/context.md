# プロジェクトコンテキスト

## プロジェクト概要

WBroker-rs は、Raspberry Pi Zero 2 W 向けの温度・湿度監視システムです。BME280 環境センサーからデータを取得し、SO1602A OLED 文字ディスプレイに表示します。

## 技術的制約条件

### ハードウェア制約

- ターゲット: Raspberry Pi Zero 2 W (ARMv7 アーキテクチャ)
- センサー: BME280 (I2C 通信)
- ディスプレイ: SO1602A 16x2 OLED 文字ディスプレイ
- メモリ制約: 組み込みデバイス向け最適化が必要

### ソフトウェア制約

- 言語: Rust
- クロスコンパイル: `armv7-unknown-linux-gnueabihf`
- GPIO/I2C 通信: `rppal` クレート使用
- リアルタイム性: 200ms 間隔でのデータ更新

## アーキテクチャ決定記録

### 1. 言語選択: Rust

- **理由**: メモリ安全性、組み込み向け最適化、クロスコンパイル対応
- **トレードオフ**: 開発速度 vs 実行時安全性・性能

### 2. ハードウェア抽象化

- **決定**: peripheral ライブラリとして分離
- **理由**: テスタビリティ向上、再利用性
- **構成**:
  - `bme280.rs`: センサードライバ
  - `so1602a.rs`: ディスプレイドライバ

### 3. ビルドシステム

- **決定**: Makefile ベースのクロスコンパイル
- **理由**: Docker 環境での一貫したビルド
- **成果物**: `dist/wbroker-rs.tar.gz` (バイナリ+systemd サービス)

## 開発環境

### 必要ツール

- `cross` (クロスコンパイル用)
- Docker (cross 実行環境)
- Make (ビルド自動化)

### テスト戦略

- 単体テスト: 各 peripheral モジュール
- 統合テスト: 実機でのハードウェアテスト
- **制約**: ハードウェア依存のため、CI での自動テストは限定的

## 運用要件

### デプロイメント

- systemd サービスとして稼働
- 自動起動設定
- ログ管理

### 監視・メンテナンス

- 温度・湿度・気圧の連続監視
- THI (Temperature-Humidity Index) 計算
- 日時表示機能
